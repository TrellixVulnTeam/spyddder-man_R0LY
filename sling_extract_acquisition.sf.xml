<?xml version="1.0"?>
<sf:sciflo xmlns:sf="http://sciflo.jpl.nasa.gov/2006v1/sf"
        xmlns:xs="http://www.w3.org/2001/XMLSchema"
        xmlns:py="http://sciflo.jpl.nasa.gov/2006v1/py">
  <sf:flow id="sling_extract_acquisition">
    <sf:title>sling_extract_acquisition</sf:title>
    <sf:description>Sling-Extract dataset from acquisition.</sf:description>
    <sf:inputs>
      <context_file>_context.json</context_file>
    </sf:inputs>
    <sf:outputs>
      <datasets from="@#extract"/>
    </sf:outputs>

    <sf:processes>

      <sf:process id="resolve">
        <sf:inputs>
          <context_file/>
        </sf:inputs>
        <sf:outputs>
          <queue/>
          <localize_url/>
          <file/>
          <prod_name/>
          <prod_date/>
        </sf:outputs>
        <sf:operator>
          <sf:description></sf:description>
          <sf:op>
            <sf:binding>python:?util.resolve_source</sf:binding>
          </sf:op>
        </sf:operator>
      </sf:process>
      
      <sf:process id="extract">
        <sf:inputs>
          <queue from="@#previous"/>
          <localize_url from="@#previous"/>
          <file from="@#previous"/>
          <prod_name from="@#previous"/>
          <prod_date from="@#previous"/>
        </sf:inputs>
        <sf:outputs>
          <datasets/>
        </sf:outputs>
        <sf:operator>
          <sf:description></sf:description>
          <sf:op>
            <sf:binding job_queue="jobs_processed" async="true">parallel:python:?util.extract_job</sf:binding>
          </sf:op>
        </sf:operator>
      </sf:process>

    </sf:processes>
  </sf:flow>
</sf:sciflo>
